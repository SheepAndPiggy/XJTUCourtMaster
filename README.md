# 🏸 XJTUCourtMaster - 体育馆场次监听与预约工具

> 基于移动交大APP接口分析的智能预约助手 · 实验性项目

[![项目状态](https://img.shields.io/badge/状态-活跃开发中-84cc16?style=flat-square)](https://github.com/your-repo)
[![验证码支持](https://img.shields.io/badge/验证码-滑动识别-06b6d4?style=flat-square)](https://github.com/your-repo)
[![时间窗口](https://img.shields.io/badge/可用时段-08:40–21:40-f59e0b?style=flat-square)](https://github.com/your-repo)

## ✨ 核心特性

- **🔍 智能监听** - 轮询监控场地空位，支持多条件筛选
- **⚡ 快速预约** - 精准定时抢场，支持特定时段直接下单  
- **🎯 验证码破解** - 图像识别 + 模拟人手拖动，高通过率
- **📱 数据同步** - 与移动交大APP实时同步，结果准确可靠
- **⏰ 智能调度** - 内置任务管理系统，避免冲突与重复

## 🚀 快速开始

### 两种工作模式

| 模式 | 功能 | 适用场景 |
|------|------|----------|
| **监听模式** | 提交 `venue_id`, `date`, `num` 参数，系统自动轮询合适空位 | 灵活抢场，多人协作 |
| **预订模式** | 提交 `venue_id`, `date`, `court_id`, `stock_id` 直接下单 | 精准预约，特定时段 |

### 基本使用

```bash
# 安装依赖（在项目根目录下运行）
pip install .

# 运行主程序（运行成功后打开网址http://127.0.0.1:5000）
python app.py
```

## ⚠️ 重要提醒

### 🚨 关键注意事项
- **必须保持主线程运行** - 监听与预约流程依赖主线程，中断会导致任务失败
- **以APP结果为准** - 网页界面和日志仅供参考，最终结果请查验移动交大APP
- **遵守时间规则** - 仅在每日 **08:40 – 21:40** 有效运行

### 📅 时间规则详解
```
08:40:00    开始监听/预约
08:40:01    预订模式默认开抢时间
21:40:00    停止服务，建议删除监听任务
```

## 🛠️ 技术架构

```
Charles抓包 → 接口分析 → 场次监听 → 验证码处理 → 模拟下单 → 结果验证
```

### 核心组件
- **网络层**: Charles代理抓包与协议分析
- **调度层**: 智能任务队列与冲突解决  
- **验证层**: 滑动验证码图像识别算法
- **执行层**: 人手行为模拟与请求优化

## 📋 项目状态

| 功能 | 状态 | 备注 |
|------|------|------|
| 基础监听/预约 | ✅ 已完成 | 稳定运行 |
| 验证码识别 | ✅ 已完成 | 持续优化中 |
| 智能调度 | 🛠️ 开发中 | 冲突处理增强 |
| 失败重试 | 🛠️ 开发中 | 策略优化 |

## ❓ 常见问题

### Q: 为什么必须保持主线程运行？
A: 任务调度、会话保活和验证码处理都在主事件循环中，挂起会导致错过关键时机。

### Q: 监听不到空位怎么办？
A: 检查时间窗口、网络连接、账号状态和验证码通过率，优先在APP内复核。

### Q: 网页显示与APP不一致？
A: **以移动交大APP实际结果为准**，网页仅作可视化参考。

## 📝 使用建议

1. **合理设置目标数量**，避免过度抢占资源
2. **关注日志输出**，监控验证码识别率和请求成功率
3. **异常时优先查验APP**，确保数据准确性
4. **非可用时段及时清理任务**，减少系统负载

## ⚖️ 合规声明

> 本项目仅用于学习研究目的，请遵守相关法律法规及平台使用条款。所有数据以平台实际返回为准，因接口变更导致的异常属可预期风险。

---

**📞 技术支持**: 遇到问题请查看日志输出并在APP内验证结果  
**🔔 更新提示**: 项目持续演进中，请关注最新版本功能优化

---

<div align="center">

**© XJTUCourtMaster · 仅供学习研究 · 以移动交大APP结果为准**

</div>