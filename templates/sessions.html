{% extends "base.html" %}
{% block title %}åœºæ¬¡ç®¡ç† - XJTUCourtMaster{% endblock %}

{% block head_extra %}
<style>
  .badge {
    display:inline-flex; align-items:center; gap:6px; font-size:12px; font-weight:700; letter-spacing:.2px;
    padding:6px 8px; border-radius:10px; border:1px solid rgba(255,255,255,.08);
  }
  .b-mode-listen { background: rgba(6,182,212,.14); border-color: rgba(6,182,212,.35); }   /* ç›‘å¬ */
  .b-mode-book   { background: rgba(132,204,22,.12); border-color: rgba(132,204,22,.35); } /* é¢„è®¢ */
  .b-sta-success { background: rgba(22,163,74,.14);  border-color: rgba(22,163,74,.35); }  /* æˆåŠŸ */
  .b-sta-failed  { background: rgba(239,68,68,.14);  border-color: rgba(239,68,68,.35); }  /* å¤±è´¥ */
  .b-sta-listen  { background: rgba(59,130,246,.14); border-color: rgba(59,130,246,.35); } /* æ­£åœ¨ç›‘å¬ */
  .td-actions { white-space: nowrap; }
  .btn-del { padding:6px 10px; }
</style>
{% endblock %}

{% block page_header %}
<div class="page-header">
  <div>
    <div class="page-title">ğŸ“‹ åœºæ¬¡ç®¡ç†</div>
    <div class="page-sub">æŸ¥çœ‹ä¸ç®¡ç†è¿‘æœŸä»»åŠ¡</div>
  </div>
  <!-- å·²æŒ‰è¦æ±‚ç§»é™¤â€œæ–°å¢/ç¼–è¾‘â€å…¥å£ï¼Œä»…ä¿ç•™å±•ç¤ºä¸åˆ é™¤ -->
</div>
{% endblock %}

{% block content %}
<table style="width:100%; border-collapse: collapse;">
  <thead>
    <tr style="text-align:left; border-bottom:1px solid var(--border);">
      <th style="padding:10px 8px; width:70px;">ID</th>
      <th style="padding:10px 8px;">æ—¥æœŸ</th>
      <th style="padding:10px 8px;">åœºé¦†åç§°</th>
      <th style="padding:10px 8px;">æ¨¡å¼</th>
      <th style="padding:10px 8px;">çŠ¶æ€</th>
      <th style="padding:10px 8px; width:120px;">æ“ä½œ</th>
    </tr>
  </thead>
  <tbody>
  {# æ³¨æ„ï¼šè¿™é‡Œæ˜¾ç¤ºçš„ ID ä½¿ç”¨ loop.index ä¿è¯ 1,2,3â€¦ é¡ºåº #}
  {% for s in sessions %}
    <tr style="border-bottom:1px solid var(--border);">
      <td style="padding:10px 8px;">{{ loop.index }}</td>
      <td style="padding:10px 8px;">{{ s.date }}</td>
      <td style="padding:10px 8px;">{{ s.venue_name }}</td>
      <td style="padding:10px 8px;">
        {% if s.mode == 'listen' %}
          <span class="badge b-mode-listen">ç›‘å¬</span>
        {% else %}
          <span class="badge b-mode-book">é¢„è®¢</span>
        {% endif %}
      </td>
      <td style="padding:10px 8px;">
        {% if s.status == 'success' %}
          <span class="badge b-sta-success">æˆåŠŸ</span>
        {% elif s.status == 'failed' %}
          <span class="badge b-sta-failed">å¤±è´¥</span>
        {% else %}
          <span class="badge b-sta-listen">æ­£åœ¨ç›‘å¬</span>
        {% endif %}
      </td>
      <td class="td-actions" style="padding:10px 8px;">
        <form method="post" action="{{ url_for('task_delete', task_id=s.id) }}" style="display:inline;">
          {% if csrf_token is defined %}<input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>{% endif %}
          <button class="btn btn-danger btn-del" type="submit" onclick="return confirm('ç¡®è®¤åˆ é™¤è¯¥ä»»åŠ¡ï¼Ÿ');">åˆ é™¤</button>
        </form>
      </td>
    </tr>
  {% else %}
    <tr>
      <td colspan="8" style="padding:12px 8px;">
        <div class="flash info">æš‚æ— ä»»åŠ¡ã€‚</div>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
