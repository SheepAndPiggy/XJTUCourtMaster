<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{% block title %}XJTUCourtMaster{% endblock %}</title>

    <!-- 主题变量与基础样式（自包含，无外链） -->
    <style>
        :root{
            --bg: #0b1220;
            --card: #0f1b2e;
            --brand-prim: #06b6d4;   /* 青绿：速度/敏捷 */
            --brand-accent: #84cc16; /* 青柠：活力/爆发 */
            --text: #e6f2ff;
            --muted: #9fb3c8;
            --border: #22314a;
            --danger: #ef4444;
            --shadow: 0 10px 30px rgba(0,0,0,.35);
            --radius: 16px;
        }
        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            margin:0;
            color:var(--text);
            background:
                    radial-gradient(1200px 600px at 80% -10%, rgba(6,182,212,.25), transparent 60%),
                    radial-gradient(800px 400px at -10% 20%, rgba(132,204,22,.2), transparent 60%),
                    linear-gradient(180deg, #0b1220 0%, #0b1324 100%);
            font: 16px/1.55 ui-sans-serif, system-ui, -apple-system, "PingFang SC", "Microsoft YaHei", "Segoe UI", Roboto, "Helvetica Neue", Arial;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* 顶部导航 */
        .navbar{
            position: sticky; top:0; z-index:50;
            backdrop-filter: saturate(140%) blur(8px);
            background: rgba(8,14,26,.6);
            border-bottom:1px solid var(--border);
            transition: box-shadow .25s ease, background .25s ease, transform .25s ease;
        }
        .navbar.scrolled{ box-shadow: var(--shadow); background: rgba(8,14,26,.8); }
        .nav-wrap{ max-width: 1100px; margin:0 auto; padding: 10px 18px; display:flex; align-items:center; gap:14px; }

        .brand{
            display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text);
            padding:8px 10px; border-radius: 12px; transition: transform .25s ease;
        }
        .brand:hover{ transform: translateY(-1px); }
        .brand-badge{
            width:32px;height:32px;border-radius:10px;display:grid;place-items:center;
            background: linear-gradient(135deg, var(--brand-prim), var(--brand-accent));
            box-shadow: 0 6px 18px rgba(6,182,212,.35), 0 3px 10px rgba(132,204,22,.25);
        }
        .brand svg{display:block}

        .nav{
            display:flex; align-items:center; gap:6px; margin-left:6px; flex:1;
        }
        .nav a{
            --pad: 10px 14px;
            position:relative; display:inline-flex; align-items:center; gap:8px;
            padding: var(--pad);
            color:var(--text); text-decoration:none; border-radius:12px;
            transition: background .2s ease, transform .2s ease;
        }
        .nav a::after{
            content:""; position:absolute; left:12px; right:12px; bottom:6px; height:2px;
            background: linear-gradient(90deg, var(--brand-accent), var(--brand-prim));
            transform: scaleX(0); transform-origin: left; transition: transform .25s ease;
            opacity:.75; border-radius:2px;
        }
        .nav a:hover{ background: rgba(255,255,255,.04); transform: translateY(-1px); }
        .nav a:hover::after{ transform: scaleX(1); }
        .nav a.active{
            background: linear-gradient(180deg, rgba(6,182,212,.14), rgba(132,204,22,.12));
            border:1px solid rgba(6,182,212,.3);
            box-shadow: inset 0 0 0 1px rgba(132,204,22,.25);
        }
        .spacer{ flex:1 }

        .userbar{
            display:flex; align-items:center; gap:12px;
            padding-left:8px; border-left:1px dashed var(--border);
        }
        .username{
            color:var(--muted); font-weight:600; letter-spacing:.2px;
            display:inline-flex; align-items:center; gap:8px;
        }
        .btn{
            --bg: rgba(6,182,212,.12); --bgH: rgba(6,182,212,.18); --bor: rgba(6,182,212,.35);
            appearance:none; border:none; outline:none; cursor:pointer;
            padding:10px 14px; border-radius:12px; color:var(--text);
            background: var(--bg); border:1px solid var(--bor);
            font-weight:600; letter-spacing:.2px; position:relative; overflow:hidden;
            transition: transform .15s ease, background .2s ease, border-color .2s ease;
        }
        .btn:hover{ background: var(--bgH); transform: translateY(-1px); }
        .btn:active{ transform: translateY(0); }
        .btn-danger{ --bg: rgba(239,68,68,.12); --bgH: rgba(239,68,68,.18); --bor: rgba(239,68,68,.35); }

        /* 闪存消息 */
        .flashes{
            max-width: 980px; margin: 18px auto 0; padding: 0 18px;
            display:flex; flex-direction:column; gap:10px;
        }
        .flash{
            padding:12px 14px; border-radius:12px; border:1px solid var(--border); background: rgba(255,255,255,.03);
        }
        .flash.info{ border-color: rgba(6,182,212,.35); background: rgba(6,182,212,.08); }
        .flash.success{ border-color: rgba(132,204,22,.35); background: rgba(132,204,22,.10); }
        .flash.error{ border-color: rgba(239,68,68,.35); background: rgba(239,68,68,.10); }

        /* 页面主容器 */
        main{ max-width:1100px; margin: 24px auto 60px; padding: 0 18px; }
        .card{
            background: var(--card); border:1px solid var(--border); border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        /* 羽毛球轻量动效：右上角有一只“悬浮”的羽毛球 */
        .shuttle{
            position: fixed; right: -24px; top: 80px; width:120px; opacity:.20; pointer-events:none;
            filter: drop-shadow(0 6px 10px rgba(0,0,0,.3));
            animation: float 6s ease-in-out infinite, spin 14s linear infinite;
        }
        @keyframes float{
            0%{ transform: translateY(0) translateX(0) }
            50%{ transform: translateY(-10px) translateX(-6px) }
            100%{ transform: translateY(0) translateX(0) }
        }
        @keyframes spin{
            0%{ rotate:0deg } 100%{ rotate:360deg }
        }
        @media (prefers-reduced-motion: reduce){
            .navbar, .brand, .nav a, .btn, .shuttle{ animation:none !important; transition:none !important }
        }

        /* 移动端 */
        .menu-toggle{ display:none }
        @media (max-width: 760px){
            .nav-wrap{ gap:8px }
            .nav{ display:none }
            .nav.show{ display:flex; position:absolute; top:58px; left:0; right:0; padding:10px 14px; flex-direction:column; gap:8px; background: rgba(8,14,26,.95); border-bottom:1px solid var(--border); }
            .menu-toggle{ display:inline-flex; margin-left:auto }
            .spacer{ display:none }
            .userbar{ margin-left:auto; border-left:none; }
            .username span{ display:none } /* 小屏隐藏“你好，”字样，仅保留名字 */
        }

        /* 可选内容区头部 */
        .page-header{
            display:flex; align-items:end; justify-content:space-between; gap:16px; margin-bottom:16px;
        }
        .page-title{ font-size: 22px; font-weight:800; letter-spacing:.3px }
        .page-sub{ color:var(--muted); font-size:14px }
    </style>

    {% block head_extra %}{% endblock %}
</head>
<body>

<!-- 轻量品牌/导航 -->
<header class="navbar" id="navbar">
    <div class="nav-wrap">
        <a class="brand" href="{{ url_for('static', filename='announcement.html') }}">
        <span class="brand-badge" aria-hidden="true">
          <!-- 羽毛球icon（简化） -->
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M3 7l14 14 3-3L6 4 3 7z" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M5 9l6 6M7 5l6 6" stroke="white" stroke-opacity=".9" stroke-width="1.2"/>
          </svg>
        </span>
            <strong>XJTUCourtMaster</strong>
        </a>

        <button class="btn menu-toggle" id="menuToggle" aria-label="展开菜单">菜单</button>

        <nav class="nav" id="navMenu" aria-label="主导航">
            <a href="{{ url_for('home') }}"
               class="{% if active_page=='home' %}active{% endif %}"
               {% if active_page=='home' %}aria-current="page"{% endif %}>🏠 主页</a>

            <a href="{{ url_for('session_manage') }}"
               class="{% if active_page=='sessions' %}active{% endif %}"
               {% if active_page=='sessions' %}aria-current="page"{% endif %}>📋 场次管理</a>
        </nav>

        <div class="spacer"></div>

        <div class="userbar">
            <div class="username" title="当前用户">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <circle cx="12" cy="8" r="4" stroke="currentColor" opacity=".6" />
                    <path d="M4 20c.8-4 5-6 8-6s7.2 2 8 6" stroke="currentColor" opacity=".6"/>
                </svg>
                <span>你好，</span>
                <strong>{{ username }}</strong>
            </div>

            <form method="post" action="{{ logout_url }}">
                {% if csrf_token is defined %}<input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>{% endif %}
                <button type="submit" class="btn btn-danger" aria-label="退出登录">退出</button>
            </form>
        </div>
    </div>
</header>

<!-- 闪存消息 -->
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<div class="flashes" role="status">
    {% for category, message in messages %}
    <div class="flash {{ category }}">{{ message }}</div>
    {% endfor %}
</div>
{% endif %}
{% endwith %}

<main>
    {% block page_header %}
    <!-- 示例：页面标题区（可在子模板里覆盖） -->
    <!--
    <div class="page-header">
      <div>
        <div class="page-title">页面标题</div>
        <div class="page-sub">这里是简介/副标题</div>
      </div>
      <div class="page-actions">
        <a class="btn">新增</a>
      </div>
    </div>
    -->
    {% endblock %}

    <section class="card" style="padding:18px;">
        {% block content %}{% endblock %}
    </section>
</main>

<script>
    // 顶栏阴影 & 移动菜单
    (function(){
        const nav = document.getElementById('navbar');
        const menu = document.getElementById('navMenu');
        const toggle = document.getElementById('menuToggle');
        const onScroll = () => { if(window.scrollY > 4) nav.classList.add('scrolled'); else nav.classList.remove('scrolled'); }
        window.addEventListener('scroll', onScroll, {passive:true});
        onScroll();
        if(toggle){
            toggle.addEventListener('click', ()=> menu.classList.toggle('show'));
        }
    })();
</script>

{% block scripts %}{% endblock %}
</body>
</html>
